---
title: "С помощью событий объекта (издатель)"
ms.prod: publisher
ms.assetid: 29b60d3c-3049-2ba9-8688-e46c4323e9ba
ms.date: 06/08/2017
ms.openlocfilehash: c1a1f69b72f0e04e5ac2cd21f5015f584db1f1a7
ms.sourcegitcommit: 1102fd44df64f18dc0561d0b3a7103ca81e74318
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/26/2017
---
# <a name="using-events-with-the-application-object-publisher"></a>С помощью событий объекта (издатель)

Чтобы создать обработчик событий для события объекта **Application** , необходимо выполнить следующие три действия:


1.  [Объявите объектную переменную в модуле класса для ответа на события.](#declare)
    
2.  [Написание процедуры определенных событий.](#write)
    
3.  [Инициализация объявленные объект из другого модуля.](#initialize)
    

## <a name="declare-the-object-variable"></a>Объявите объектную переменную

Перед внесением процедур для событий объекта **приложения** , необходимо создать новый модуль класса и объявите объект типа **приложения** с событиями. Например предположим, что новый модуль класса создается и вызывается EventClassModule. Новый модуль класса содержит следующий код.


```vb
Public WithEvents App As Publisher.Application
```


## <a name="write-the-event-procedures"></a>Написание процедуры событий

После объявления новый объект с событиями оно отображается в поле раскрывающегося списка **объектов** в модуле класса, и можно написать процедур обработки событий для этого нового объекта. (При выборе этого нового объекта в поле " **объект** " допустимый события для этого объекта, перечислены в раскрывающемся списке **процедуры** .) Выберите событие в раскрывающемся списке поле **процедуры** ; пустой процедуре добавляется в модуле класса.


```vb
Private Sub App_DocumentOpen() 
 
End Sub
```


## <a name="initialize-the-declared-object"></a>Инициализировать объект объявленные

Перед выполнением процедуры, необходимо подключить объект объявленного в модуле класса (приложение в этом примере) с помощью объекта **приложения** . Это можно сделать с помощью следующего кода из любого модуля.


```vb
Dim X As New EventClassModule 
Sub Register_Event_Handler() 
 Set X.App = Publisher.Application 
End Sub
```

Выполните процедуру, Register_Event_Handler. После выполнения процедуры объект приложения в модуль класса указывает на объект Microsoft Publisher **приложения** и процедур обработки событий в модуле класса будут работать при возникновении событий.


 **Примечание**  Сведения о создании процедур обработки событий для объекта **Document** содержатся в разделе [С помощью событий с помощью объекта Document](using-events-with-the-document-object-publisher.md).


